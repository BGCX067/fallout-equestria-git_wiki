#summary Describe the internal mechanics of the SPECIAL system

= Introduction =

Our implementation of the SPECIAL system, a.k.a the Cutie Mark Aquisition Program, is a big deal for the game engine. We had to do something flexible, allowing to tweaks any statistic, implement new perks, traits with very much ease.

N.B.: We didn't give the possibility to have a statistic system that doesn't use the Fallout-like SPECIAL system (you can't use anything else than: Traits / SPECIAL / Statistics / Skills / Perks. You can however implement a lot of new behaviours using these, or part of these).

The Cutie Mark Acquisition Program (CMAP for short) has been designed so that on the long term, it can also be used on other engine. The only dependency is the scripting engine AngelScript, and the event management system from our engine (which can easily be used anywhere else).

The CMAP uses:
  * JSON for the character sheets design,
  * AngelScript for almost all data management,
  * Rocket for displaying character sheets in-game.

This means that you can tweak all the statistic mechanics directly from the special.as script (such as how much the strenght of a character should affect the melee damage he deals or his carry weight capacity).

It also means that you can change the content of each statistic category (you can add traits, special attributes, statistics, skills and perks as you wish: they will be properly displayed in the view and you will be able to handle the mechanics from scripts).

And it also means that the view is designed using RML/RCSS.
So you can change it to your needs as well without a sweat.

= Details =

We'll detail the structure of the charsheet model and how to modify it.
Then we'll go over the many hooks the the script file can implement.

=== TODO: do what the two last lines says ===

== General Information ==
The statistic sheet starts with the primary informations:
{{{
"Name": "Character's name",
"Age": 16,
"Gender": "Male/Female",
"Race": "Changeling",
"Faction": "A faction name"
}}}

The faction system will be explained later in this document. It is used to determine who attacks you on sight and who doesn't.

== SPECIAL Points ==
The primary statistics are the SPECIAL values that we all came to know quite well: in order, Strength, Perception, Endurance, Charisma, Intelligence, Agility, Luck.
The statistic sheet depict them like this:
{{{
"Special": {
  "STR": 5,
  "PER": 5,
  "END": 5,
  "CHA": 5,
  "INT": 5,
  "AGI": 5,
  "LUC": 5
}
}}}

SPECIAL will have an impact on the Statistics and the Skills.
The SPECIAL points don't change as the player gains levels, but they can be influenced by modifiers.

== Skills ==
Skills are competences that improve over time. The skills are arbitrary and are left to the choice of the game developer.
Some of them though are directly required by the engine:

  * Outdoorspony, which is used in the worldmap to raise the chances of detecting encounters before they detect you.
  * Sneak, which cause enemy characters to make a test before detecting an enemy.

The data is stored in two parts: the first contains the current level for each skill, and the second stores the amount of skill points that the player spent on specific skills. It looks like this:

{{{
"Skills": {
  "Small Guns": 0,
  "Big Guns": 0,
  "Energy Guns": 15,
  "etc...": 0
},
"Skill Points": {
  "Small Guns": 0,
  "Big Guns": 0,
  "Energy Guns": 15,
  "etc...": 0
}
}}}

== Statistics ==
The statistics are a set of values with a practical application in the game:

{{{
"Statistics": {
  "Action Points": 5,
  "Armor Class": 5,
  "Bonus Damage": 0
  "Carry Weight": 100,
  "Critical Chance": 7,
  "Damage Resistance": 0,
  "Healing Rate": 1,
  "Hit Points": 26,
  "Melee Damage": 1,
  "Perk Rate": 3,
  "Poison Resistance": 15,
  "Radiation Resistance": 6,
  "Skill Rate": 19
}
}}}

These fields are directly from the original Fallout. Only some of these are actually mandatory:

  * Action Points
  * Armor Class: define the chances of a character to dodge an attack
  * Carry Weight
  * Healing Rate: how many hit points are healed each day.
  * Hit Points
  * Perk Rate: how much level must pass for a new perk to become available
  * Skill Rate: how much skill points are gained each level

Just like for the skills, there's a second store called "Statistics Modifiers" which needs to be used when a perk, item or whatever, changes the value of a statistic.
It stores the amount of all the cumulated changes in a statistic, so that the CMAP can recompute correctly the statistic when needed.

== Traits ==
Traits are specific traits of a character picked at the creation of a statistic sheet. They can never change over time.
The usual philosophy behind a trait is that they are always both a curse and a blessing. For instance, if it makes you stronger, it also makes you slower.

The default amount of traits available is two. Though it is possible to have more (or less) as long as it is done during the statistic sheet creation step.

== Perks ==
Perks are special. Perks will be explained here.

== Faction ==
Factions are special too. They'll be explained there.

== The special.as script ==
The special.as script, for some reason currently located in the script/ai directory, is used to react to events from the statistic interface sheet, or to other changes of the character (such as gaining a level or some experience).

The special.as script is also used to select which enemy are encountered when an encounter happens on the world map.